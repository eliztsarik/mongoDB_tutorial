# mongoDB_tutorial

1. монго использует BSON а не JSON. BSON - binary JSON - двоичная кодировка JSON-подобных документов, которые MongoDB использует при хранении документов в коллекциях. Он добавляет поддержку типов данных, таких как Date и двоичные файлы, которые не поддерживаются в JSON, так же увкличивает скорость обработки данных, но весит немного больше JSON.
3. Возможность создавать вторичные индексы (до 64 над одной коллекцией)

Репликация

Система хранения данных в MongoDB представляет набор реплик. В этом наборе есть основной узел, а также может быть набор вторичных узлов. Все вторичные узлы сохраняют целостность и автоматически обновляются вместе с обновлением главного узла. И если основной узел по каким-то причинам выходит из строя, то один из вторичных узлов становится главным.

mongod - запуск самого сервиса монги

Справка: db.help()
Для получения справки о методе надо вызвать его без скобок
db.table.save - в справке указано, что это обертка над методами insert и update

Для создания базы данных можно использовать просто use db_name.В этом случае, если БД еще не была создана, то она автоматически создастся и область действия перейдет на данную БД.

Создание таблицы происходит аналогичным образом.

ЗДЕСЬ ДОЛЖНЫ БЫТЬ ТИПЫ ДАННЫХ

Для поииска по таблице используется 
- db.table.find()
- db.table.findOne()
- db.table.find({key: "value"})
- db.table.find({"key.key1": "value"})
- db.table.find({"key.key1": null}) - для поиска документов, в которых нет данного свойства
- db.table.find().pretty())
find по дефолту выдает первые 20 записей, чтобы показать следуюшие записи, нужно выполнить команду it

При вставке любого документа или значения, если нет значения "_id", то оно формируется автоматически

для подсчета количества вставленных документов используется db.table.count()

Правила именования БД\табиц\пар ключ-значение

CRUD операции
Вставка и выборка:
1. database.table.insert({key: "value"}) (insertOne({})/insertMany([{}, {}, ..., {}]) соответственно)
2. можно создать отдельно переменную (просто name = {...}, и затем заинсертить ее в следующей строчки, передав в качестве параметра в метод insert\save
3. database.table.save({key: "value"})
4. Для загрузки файла в бд используется команда load("Path/to/file.js")
Стоит отметить, что если синтаксически выражение не закончено, то при переходе на новую строку интерпретатор будет просто продолжать выражение

Обновление:
1. database.table.update({key: "value"}, {$set: {key: "value"}})
2. database.table.update({key: "value"}, {$unset: {key: "value"}})
3. database.table.update({"key.key1": "value"}, 
                         {$addToSet: {"key.key1": "value"}}, false, true)
  последний параметр говорит о множественном обновлении. По дефолту операция обновления применяется только для первого подходящего значения

Удаление:
1. db.table.remove() - удалит из коллекции все значения
2. db.table.remove({key: "value"})
3. db.table.drop() - удаляет таблицу

Операции сравнения:
1. $gt - greater than
2. $lt - less than
db.table.find({"$gt": 12345})
db.table.find({"$gt": 1, "$lt": 234})

Индексы:
- db.table.find({"$gt": 24332}).explain() - путь выполнения запроса, позволяющий отследить узкие места, посмотреть, какие индексы были использованы, и в целом посмотреть метрики запроса
- если тип курсора BasicCursor - для вычисления запроса не использовали индексы.
- Построить индекс можно с помощью метода ensureIndex()
- db.table.ensureIndex({"key": 1}) - построить индекс по полю key по возрастанию
- Для проверки наличия индексов используется метод db.table.getIndexes()

Основы администрирования:
- mongod - запуск самого сервиса монги
- show dbs - показать все доступные БД
- db - показать, какая база установленна на данный момент в качестве используемой
- show collections/show tables - показывает все коллекции в текущей БД
- db.stats()\db.table.stats() - получение низкоуровневой информации о БД или коллекции


